{"componentChunkName":"component---src-templates-post-template-tsx","path":"/diff-svc 음성파일 (전처리)만드는 법/","result":{"data":{"allMarkdownRemark":{"edges":[{"node":{"html":"<p>아래는 PyDub 라이브러리를 사용하여 음성 파일을 자동으로 분리하고 무음을 제거하는 Python 코드입니다. diff-svc 음성파일을 더 쉽게 만들기 위해 제작하였습니다.</p>\n<h1 id=\"PyDub을-사용한-음성-파일-분리-및-무음-제거\" style=\"position:relative;\">PyDub을 사용한 음성 파일 분리 및 무음 제거<a href=\"#PyDub%EC%9D%84-%EC%82%AC%EC%9A%A9%ED%95%9C-%EC%9D%8C%EC%84%B1-%ED%8C%8C%EC%9D%BC-%EB%B6%84%EB%A6%AC-%EB%B0%8F-%EB%AC%B4%EC%9D%8C-%EC%A0%9C%EA%B1%B0\" aria-label=\"PyDub을 사용한 음성 파일 분리 및 무음 제거 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h1>\n<h2 id=\"개요\" style=\"position:relative;\">개요<a href=\"#%EA%B0%9C%EC%9A%94\" aria-label=\"개요 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>이번 포스트에서는 Python 라이브러리인 PyDub을 사용하여 음성 파일을 전처리하는 방법을 알아보겠습니다. PyDub은 오디오 파일의 다양한 처리 작업을 수행할 수 있는 라이브러리로, 간단한 API와 함께 사용하기 쉽습니다. 이번 포스트에서는 PyDub을 사용하여 음성 파일을 무음 구간을 기준으로 분리하고, 분리된 오디오 조각들을 최대 15초까지만 선택하여 WAV 파일로 저장하고, 마지막으로 무음을 제거하는 작업을 수행하는 코드를 살펴보겠습니다.</p>\n<h3 id=\"들어가기에-앞서-아래코드는-pydub-라이브러리가-필요합니다\" style=\"position:relative;\">들어가기에 앞서 아래코드는 pydub 라이브러리가 필요합니다.<a href=\"#%EB%93%A4%EC%96%B4%EA%B0%80%EA%B8%B0%EC%97%90-%EC%95%9E%EC%84%9C-%EC%95%84%EB%9E%98%EC%BD%94%EB%93%9C%EB%8A%94-pydub-%EB%9D%BC%EC%9D%B4%EB%B8%8C%EB%9F%AC%EB%A6%AC%EA%B0%80-%ED%95%84%EC%9A%94%ED%95%A9%EB%8B%88%EB%8B%A4\" aria-label=\"들어가기에 앞서 아래코드는 pydub 라이브러리가 필요합니다 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h3>\n<p>파이썬 2.7, 3.3 이상의 버전에서 사용 가능합니다. pydub를 설치하려면 pip를 사용합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">pip install pydub\n</code></pre></div>\n<h2 id=\"코드\" style=\"position:relative;\">코드<a href=\"#%EC%BD%94%EB%93%9C\" aria-label=\"코드 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h2>\n<p>먼저 필요한 라이브러리를 import합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pydub <span class=\"token keyword\">import</span> AudioSegment\n<span class=\"token keyword\">from</span> pydub<span class=\"token punctuation\">.</span>silence <span class=\"token keyword\">import</span> split_on_silence\n<span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> subprocess\n</code></pre></div>\n<p>다음으로, 입력 파일 경로와 출력 폴더를 설정합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">input_file <span class=\"token operator\">=</span> <span class=\"token string\">'input_file.mp3'</span>\noutput_folder <span class=\"token operator\">=</span> <span class=\"token string\">'output_folder'</span>\n</code></pre></div>\n<p>이제, 입력 파일을 PyDub으로 로드하고, 샘플링 레이트, 채널, 샘플 넓이를 설정합니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">sound <span class=\"token operator\">=</span> AudioSegment<span class=\"token punctuation\">.</span>from_file<span class=\"token punctuation\">(</span>input_file<span class=\"token punctuation\">)</span>\nsound <span class=\"token operator\">=</span> sound<span class=\"token punctuation\">.</span>set_frame_rate<span class=\"token punctuation\">(</span><span class=\"token number\">44100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>set_channels<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>set_sample_width<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n</code></pre></div>\n<p>이제, PyDub의 split_on_silence() 함수를 사용하여 입력된 음성 파일을 무음을 기준으로 자동으로 분리합니다. 이 함수는 최소 무음 길이, 무음으로 간주되는 dBFS 값, 분리된 각 음성 조각들 간의 추가적인 무음 길이를 인자로 받습니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\">audio_chunks <span class=\"token operator\">=</span> split_on_silence<span class=\"token punctuation\">(</span>sound<span class=\"token punctuation\">,</span>\n    min_silence_len<span class=\"token operator\">=</span><span class=\"token number\">1000</span><span class=\"token punctuation\">,</span> <span class=\"token comment\"># 최소 무음 길이 (밀리초 단위)</span>\n    silence_thresh<span class=\"token operator\">=</span><span class=\"token operator\">-</span><span class=\"token number\">35</span><span class=\"token punctuation\">,</span> <span class=\"token comment\"># 무음으로 간주되는 dBFS 값</span>\n    keep_silence<span class=\"token operator\">=</span><span class=\"token number\">500</span> <span class=\"token comment\"># 분리된 오디오 조각들 간의 추가적인 무음 길이 (밀리초 단위)</span>\n<span class=\"token punctuation\">)</span>\n</code></pre></div>\n<p>분리된 음성 조각들 중 최대 15초까지만 선택하여 WAV 파일로 저장합니다.\n이 작업은 각 음성의 길이가 너무 긴 경우 파일 크기가 너무 커지는 것을 방지하기 위한 것입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">for</span> i<span class=\"token punctuation\">,</span> chunk <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span>audio_chunks<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">if</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>chunk<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">15000</span><span class=\"token punctuation\">:</span>\n        chunk <span class=\"token operator\">=</span> chunk<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">15000</span><span class=\"token punctuation\">]</span>\n    output_file <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>output_folder<span class=\"token punctuation\">,</span> <span class=\"token string-interpolation\"><span class=\"token string\">f'chunk_</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>i<span class=\"token punctuation\">}</span></span><span class=\"token string\">.wav'</span></span><span class=\"token punctuation\">)</span>\n    chunk<span class=\"token punctuation\">.</span>export<span class=\"token punctuation\">(</span>output_file<span class=\"token punctuation\">,</span> <span class=\"token builtin\">format</span><span class=\"token operator\">=</span><span class=\"token string\">'wav'</span><span class=\"token punctuation\">)</span>\n</code></pre></div>\n<p>마지막으로 무음제거 코드입니다.</p>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">for</span> filename <span class=\"token keyword\">in</span> os<span class=\"token punctuation\">.</span>listdir<span class=\"token punctuation\">(</span>output_folder<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">if</span> filename<span class=\"token punctuation\">.</span>endswith<span class=\"token punctuation\">(</span><span class=\"token string\">'.wav'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        input_path <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>output_folder<span class=\"token punctuation\">,</span> filename<span class=\"token punctuation\">)</span>\n        output_path <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>output_folder<span class=\"token punctuation\">,</span> <span class=\"token string-interpolation\"><span class=\"token string\">f'processed_</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>filename<span class=\"token punctuation\">}</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span>\n        subprocess<span class=\"token punctuation\">.</span>call<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'ffmpeg'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'-i'</span><span class=\"token punctuation\">,</span> input_path<span class=\"token punctuation\">,</span> <span class=\"token string\">'-af'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'silenceremove=1:0:-50dB'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'-y'</span><span class=\"token punctuation\">,</span> output_path<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n        os<span class=\"token punctuation\">.</span>remove<span class=\"token punctuation\">(</span>input_path<span class=\"token punctuation\">)</span></code></pre></div>\n<h1 id=\"전체코드\" style=\"position:relative;\">전체코드<a href=\"#%EC%A0%84%EC%B2%B4%EC%BD%94%EB%93%9C\" aria-label=\"전체코드 permalink\" class=\"custom-class after\"><svg aria-hidden=\"true\" height=\"20\" version=\"1.1\" viewBox=\"0 0 16 16\" width=\"20\"><path fill-rule=\"evenodd\" d=\"M4 9h1v1H4c-1.5 0-3-1.69-3-3.5S2.55 3 4 3h4c1.45 0 3 1.69 3 3.5 0 1.41-.91 2.72-2 3.25V8.59c.58-.45 1-1.27 1-2.09C10 5.22 8.98 4 8 4H4c-.98 0-2 1.22-2 2.5S3 9 4 9zm9-3h-1v1h1c1 0 2 1.22 2 2.5S13.98 12 13 12H9c-.98 0-2-1.22-2-2.5 0-.83.42-1.64 1-2.09V6.25c-1.09.53-2 1.84-2 3.25C6 11.31 7.55 13 9 13h4c1.45 0 3-1.69 3-3.5S14.5 6 13 6z\"></path></svg></a></h1>\n<div class=\"gatsby-highlight\" data-language=\"python\"><pre class=\"language-python\"><code class=\"language-python\"><span class=\"token keyword\">from</span> pydub <span class=\"token keyword\">import</span> AudioSegment\n<span class=\"token keyword\">from</span> pydub<span class=\"token punctuation\">.</span>silence <span class=\"token keyword\">import</span> split_on_silence\n<span class=\"token keyword\">import</span> os\n<span class=\"token keyword\">import</span> subprocess\n\n<span class=\"token comment\"># 음성파일 경로 설정</span>\ninput_file <span class=\"token operator\">=</span> <span class=\"token string\">'input_file.mp3'</span>\noutput_folder <span class=\"token operator\">=</span> <span class=\"token string\">'output_folder'</span>\n\n<span class=\"token comment\"># 오디오 파일 로드 및 변환</span>\nsound <span class=\"token operator\">=</span> AudioSegment<span class=\"token punctuation\">.</span>from_file<span class=\"token punctuation\">(</span>input_file<span class=\"token punctuation\">)</span>\nsound <span class=\"token operator\">=</span> sound<span class=\"token punctuation\">.</span>set_frame_rate<span class=\"token punctuation\">(</span><span class=\"token number\">44100</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>set_channels<span class=\"token punctuation\">(</span><span class=\"token number\">1</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">.</span>set_sample_width<span class=\"token punctuation\">(</span><span class=\"token number\">2</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 무음 구간을 기준으로 오디오 파일 분리</span>\naudio_chunks <span class=\"token operator\">=</span> split_on_silence<span class=\"token punctuation\">(</span>sound<span class=\"token punctuation\">,</span>\n    min_silence_len<span class=\"token operator\">=</span><span class=\"token number\">1000</span><span class=\"token punctuation\">,</span> <span class=\"token comment\"># 최소 무음 길이 (밀리초 단위)</span>\n    silence_thresh<span class=\"token operator\">=</span><span class=\"token operator\">-</span><span class=\"token number\">35</span><span class=\"token punctuation\">,</span> <span class=\"token comment\"># 무음으로 간주되는 dBFS 값</span>\n    keep_silence<span class=\"token operator\">=</span><span class=\"token number\">500</span> <span class=\"token comment\"># 분리된 오디오 조각들 간의 추가적인 무음 길이 (밀리초 단위)</span>\n<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 출력 파일명 설정 및 출력 폴더 생성</span>\n<span class=\"token keyword\">if</span> <span class=\"token keyword\">not</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>exists<span class=\"token punctuation\">(</span>output_folder<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    os<span class=\"token punctuation\">.</span>makedirs<span class=\"token punctuation\">(</span>output_folder<span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 분리된 오디오 조각들 중 최대 15초까지만 선택하여 wav 파일로 저장</span>\n<span class=\"token keyword\">for</span> i<span class=\"token punctuation\">,</span> chunk <span class=\"token keyword\">in</span> <span class=\"token builtin\">enumerate</span><span class=\"token punctuation\">(</span>audio_chunks<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">if</span> <span class=\"token builtin\">len</span><span class=\"token punctuation\">(</span>chunk<span class=\"token punctuation\">)</span> <span class=\"token operator\">></span> <span class=\"token number\">15000</span><span class=\"token punctuation\">:</span>\n        chunk <span class=\"token operator\">=</span> chunk<span class=\"token punctuation\">[</span><span class=\"token punctuation\">:</span><span class=\"token number\">15000</span><span class=\"token punctuation\">]</span>\n    output_file <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>output_folder<span class=\"token punctuation\">,</span> <span class=\"token string-interpolation\"><span class=\"token string\">f'chunk_</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>i<span class=\"token punctuation\">}</span></span><span class=\"token string\">.wav'</span></span><span class=\"token punctuation\">)</span>\n    chunk<span class=\"token punctuation\">.</span>export<span class=\"token punctuation\">(</span>output_file<span class=\"token punctuation\">,</span> <span class=\"token builtin\">format</span><span class=\"token operator\">=</span><span class=\"token string\">'wav'</span><span class=\"token punctuation\">)</span>\n\n<span class=\"token comment\"># 무음 제거</span>\n<span class=\"token keyword\">for</span> filename <span class=\"token keyword\">in</span> os<span class=\"token punctuation\">.</span>listdir<span class=\"token punctuation\">(</span>output_folder<span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n    <span class=\"token keyword\">if</span> filename<span class=\"token punctuation\">.</span>endswith<span class=\"token punctuation\">(</span><span class=\"token string\">'.wav'</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">:</span>\n        input_path <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>output_folder<span class=\"token punctuation\">,</span> filename<span class=\"token punctuation\">)</span>\n        output_path <span class=\"token operator\">=</span> os<span class=\"token punctuation\">.</span>path<span class=\"token punctuation\">.</span>join<span class=\"token punctuation\">(</span>output_folder<span class=\"token punctuation\">,</span> <span class=\"token string-interpolation\"><span class=\"token string\">f'processed_</span><span class=\"token interpolation\"><span class=\"token punctuation\">{</span>filename<span class=\"token punctuation\">}</span></span><span class=\"token string\">'</span></span><span class=\"token punctuation\">)</span>\n        subprocess<span class=\"token punctuation\">.</span>call<span class=\"token punctuation\">(</span><span class=\"token punctuation\">[</span><span class=\"token string\">'ffmpeg'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'-i'</span><span class=\"token punctuation\">,</span> input_path<span class=\"token punctuation\">,</span> <span class=\"token string\">'-af'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'silenceremove=1:0:-50dB'</span><span class=\"token punctuation\">,</span> <span class=\"token string\">'-y'</span><span class=\"token punctuation\">,</span> output_path<span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span>\n        os<span class=\"token punctuation\">.</span>remove<span class=\"token punctuation\">(</span>input_path<span class=\"token punctuation\">)</span>\n</code></pre></div>","frontmatter":{"title":"diff-svc 음성파일 (전처리)만드는 법","summary":"PyDub 라이브러리를 사용하여 음성 파일을 자동으로 분리하고 무음을 제거하는 Python 코드입니다. diff-svc 음성파일을 더 쉽게 만들기 위해 제작하였습니다.","date":"2023.04.21","categories":["Python","diff-svc"],"thumbnail":{"childImageSharp":{"gatsbyImageData":{"layout":"constrained","backgroundColor":"#080808","images":{"fallback":{"src":"/static/84fafe303a969987ed1f8a59457a80e6/f59d1/diffsvc.png","srcSet":"/static/84fafe303a969987ed1f8a59457a80e6/5404f/diffsvc.png 303w,\n/static/84fafe303a969987ed1f8a59457a80e6/97feb/diffsvc.png 607w,\n/static/84fafe303a969987ed1f8a59457a80e6/f59d1/diffsvc.png 1213w","sizes":"(min-width: 1213px) 1213px, 100vw"},"sources":[{"srcSet":"/static/84fafe303a969987ed1f8a59457a80e6/ca982/diffsvc.webp 303w,\n/static/84fafe303a969987ed1f8a59457a80e6/34609/diffsvc.webp 607w,\n/static/84fafe303a969987ed1f8a59457a80e6/58fd6/diffsvc.webp 1213w","type":"image/webp","sizes":"(min-width: 1213px) 1213px, 100vw"}]},"width":1213,"height":331}},"publicURL":"/static/84fafe303a969987ed1f8a59457a80e6/diffsvc.png"}}}}]}},"pageContext":{"slug":"/diff-svc 음성파일 (전처리)만드는 법/"}},"staticQueryHashes":[],"slicesMap":{}}